<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>轻量级服务器-Tomcat | DBLOG</title>
    <meta name="description" content="学而不思则罔">
    <meta name="generator" content="VitePress v1.4.1">
    <link rel="preload stylesheet" href="/assets/style.Bn_JqJhg.css" as="style">
    
    <script type="module" src="/assets/app.asQzgMNR.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.CPnu54i4.js">
    <link rel="modulepreload" href="/assets/chunks/framework.DPuwY6B9.js">
    <link rel="modulepreload" href="/assets/服务器_轻量级服务器-Tomcat.md.DbNj8TZK.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0f60ec36></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0f60ec36> Skip to content </a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar" data-v-ae24b3ad data-v-6aa21345><div class="wrapper" data-v-6aa21345><div class="container" data-v-6aa21345><div class="title" data-v-6aa21345><div class="VPNavBarTitle has-sidebar" data-v-6aa21345 data-v-ab179fa1><a class="title" href="/" data-v-ab179fa1><!--[--><!--]--><!--[--><img class="VPImage logo" src="/logo.png" alt data-v-8426fc1a><!--]--><span data-v-ab179fa1>DBLOG</span><!--[--><!--]--></a></div></div><div class="content" data-v-6aa21345><div class="content-body" data-v-6aa21345><!--[--><!--]--><div class="VPNavBarSearch search" data-v-6aa21345><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6aa21345 data-v-dc692963><span id="main-nav-aria-label" class="visually-hidden" data-v-dc692963> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>首页</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-dc692963 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-cf11d7a2><span class="text" data-v-cf11d7a2><!----><span data-v-cf11d7a2>高项</span><span class="vpi-chevron-down text-icon" data-v-cf11d7a2></span></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><div class="items" data-v-b98bc113><!--[--><!--[--><div class="VPMenuLink" data-v-b98bc113 data-v-35975db6><a class="VPLink link" href="/%E9%AB%98%E9%A1%B9/%E7%AC%AC8%E7%AB%A0%20%E9%A1%B9%E7%9B%AE%E6%95%B4%E5%90%88%E7%AE%A1%E7%90%86.html" data-v-35975db6><!--[--><span data-v-35975db6>第8章 项目整合管理</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-b98bc113 data-v-35975db6><a class="VPLink link" href="/%E9%AB%98%E9%A1%B9/%E7%AC%AC9%E7%AB%A0%20%E9%A1%B9%E7%9B%AE%E8%8C%83%E5%9B%B4%E7%AE%A1%E7%90%86.html" data-v-35975db6><!--[--><span data-v-35975db6>第9章 项目范围管理</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-dc692963 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-cf11d7a2><span class="text" data-v-cf11d7a2><!----><span data-v-cf11d7a2>汇总</span><span class="vpi-chevron-down text-icon" data-v-cf11d7a2></span></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><div class="items" data-v-b98bc113><!--[--><!--[--><div class="VPMenuLink" data-v-b98bc113 data-v-35975db6><a class="VPLink link" href="/Java%20SE/Java%E5%9F%BA%E7%A1%80.html" data-v-35975db6><!--[--><span data-v-35975db6>Java SE</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-b98bc113 data-v-35975db6><a class="VPLink link" href="/Java%20EE/%E5%9F%BA%E7%A1%80%E6%A1%86%E6%9E%B6/JavaSpring.html" data-v-35975db6><!--[--><span data-v-35975db6>Java EE</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-b98bc113 data-v-35975db6><a class="VPLink link" href="/%E6%9C%8D%E5%8A%A1%E5%99%A8/%E5%AE%B9%E5%99%A8%E5%8C%96%E6%8A%80%E6%9C%AF-Docker.html" data-v-35975db6><!--[--><span data-v-35975db6>服务器</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-b98bc113 data-v-35975db6><a class="VPLink link" href="/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/%E4%BB%A3%E7%A0%81%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7-Git.html" data-v-35975db6><!--[--><span data-v-35975db6>开发工具</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-b98bc113 data-v-35975db6><a class="VPLink link" href="/%E5%9B%9E%E9%A1%BE/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9B%B8%E5%85%B3.html" data-v-35975db6><!--[--><span data-v-35975db6>回顾</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-6aa21345 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-6aa21345 data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/dwxlrf" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-eee4e7cb><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-6aa21345 data-v-bb2aa2f0 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-cf11d7a2><span class="vpi-more-horizontal icon" data-v-cf11d7a2></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><!----><!--[--><!--[--><!----><div class="group" data-v-bb2aa2f0><div class="item appearance" data-v-bb2aa2f0><p class="label" data-v-bb2aa2f0>Appearance</p><div class="appearance-action" data-v-bb2aa2f0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bb2aa2f0 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bb2aa2f0><div class="item social-links" data-v-bb2aa2f0><div class="VPSocialLinks social-links-list" data-v-bb2aa2f0 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/dwxlrf" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-eee4e7cb><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6aa21345 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-6aa21345><div class="divider-line" data-v-6aa21345></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a6f0e41e><span class="vpi-align-left menu-icon" data-v-a6f0e41e></span><span class="menu-text" data-v-a6f0e41e>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-17a5e62e><button data-v-17a5e62e>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-5d98c3a5 data-v-319d5ca6><div class="curtain" data-v-319d5ca6></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-319d5ca6><span class="visually-hidden" id="sidebar-aria-label" data-v-319d5ca6> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 has-active" data-v-c40bc020 data-v-b7550ba0><!----><div class="items" data-v-b7550ba0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/%E6%9C%8D%E5%8A%A1%E5%99%A8/%E5%AE%B9%E5%99%A8%E5%8C%96%E6%8A%80%E6%9C%AF-Docker.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>容器化技术-Docker</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/%E6%9C%8D%E5%8A%A1%E5%99%A8/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-Linux.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>操作系统-Linux</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/%E6%9C%8D%E5%8A%A1%E5%99%A8/%E8%BD%BB%E9%87%8F%E7%BA%A7%E6%9C%8D%E5%8A%A1%E5%99%A8-Tomcat.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>轻量级服务器-Tomcat</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/%E6%9C%8D%E5%8A%A1%E5%99%A8/%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%8C%96%E6%8A%80%E6%9C%AF-Mysql.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>数据持久化技术-Mysql</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/%E6%9C%8D%E5%8A%A1%E5%99%A8/%E6%95%B0%E6%8D%AE%E7%BC%93%E5%AD%98%E6%8A%80%E6%9C%AF-Redis.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>数据缓存技术-Redis</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-sidebar has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="left-aside aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-a5bbad30><div class="content" data-v-a5bbad30><div class="outline-marker" data-v-a5bbad30></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a5bbad30>页面导航</div><ul class="VPDocOutlineItem root" data-v-a5bbad30 data-v-b933a997><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _%E6%9C%8D%E5%8A%A1%E5%99%A8_%E8%BD%BB%E9%87%8F%E7%BA%A7%E6%9C%8D%E5%8A%A1%E5%99%A8-Tomcat" data-v-39a288b8><div><h1 id="轻量级服务器-tomcat" tabindex="-1">轻量级服务器-Tomcat <a class="header-anchor" href="#轻量级服务器-tomcat" aria-label="Permalink to &quot;轻量级服务器-Tomcat&quot;">​</a></h1><h2 id="一、tomcat是什么" tabindex="-1">一、Tomcat是什么？ <a class="header-anchor" href="#一、tomcat是什么" aria-label="Permalink to &quot;一、Tomcat是什么？&quot;">​</a></h2><p>Tomcat 服务器Apache软件基金会项目中的一个核心项目，是一个免费的开放源代码的Web 应用服务器，属于轻量级应用服务器，在中小型系统和并发访问用户不是很多的场合下被普遍使用，是开发和调试JSP 程序的首选。</p><h2 id="二、tomcat的缺省端口是多少-怎么修改" tabindex="-1">二、Tomcat的缺省端口是多少，怎么修改 <a class="header-anchor" href="#二、tomcat的缺省端口是多少-怎么修改" aria-label="Permalink to &quot;二、Tomcat的缺省端口是多少，怎么修改&quot;">​</a></h2><ol><li>找到Tomcat目录下的conf文件夹</li><li>进入conf文件夹里面找到server.xml文件</li><li>打开server.xml文件</li><li>在server.xml文件里面找到下列信息</li><li>把Connector标签的8080端口改成你想要的端口</li></ol><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Service name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Catalina&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Connector port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;8080&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> protocol</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;HTTP/1.1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">               connectionTimeout</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;20000&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">               redirectPort</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;8443&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> /&gt;</span></span></code></pre></div><h2 id="三、tomcat-有哪几种connector-运行模式-优化" tabindex="-1">三、tomcat 有哪几种Connector 运行模式(优化)？ <a class="header-anchor" href="#三、tomcat-有哪几种connector-运行模式-优化" aria-label="Permalink to &quot;三、tomcat 有哪几种Connector 运行模式(优化)？&quot;">​</a></h2><p>下面，我们先大致了解Tomcat Connector的三种运行模式。</p><ul><li><strong>BIO：同步并阻塞</strong> 一个线程处理一个请求。缺点：并发量高时，线程数较多，浪费资源。Tomcat7或以下，在Linux系统中默认使用这种方式。</li></ul><p><strong>配制项</strong>：protocol=”HTTP/1.1”</p><ul><li>NIO：同步非阻塞IO 利用Java的异步IO处理，可以通过少量的线程处理大量的请求，可以复用同一个线程处理多个connection(多路复用)。 Tomcat8在Linux系统中默认使用这种方式。 Tomcat7必须修改Connector配置来启动。 <strong>配制项</strong>：protocol=”org.apache.coyote.http11.Http11NioProtocol” <strong>备注</strong>：我们常用的Jetty，Mina，ZooKeeper等都是基于java nio实现.</li><li>APR：即Apache Portable Runtime，从操作系统层面解决io阻塞问题。**AIO方式，**<strong>异步非阻塞IO</strong>(Java NIO2又叫AIO) 主要与NIO的区别主要是操作系统的底层区别.可以做个比喻:比作快递，NIO就是网购后要自己到官网查下快递是否已经到了(可能是多次)，然后自己去取快递；AIO就是快递员送货上门了(不用关注快递进度)。 <strong>配制项</strong>：protocol=”org.apache.coyote.http11.Http11AprProtocol” <strong>备注</strong>：需在本地服务器安装APR库。Tomcat7或Tomcat8在Win7或以上的系统中启动默认使用这种方式。Linux如果安装了apr和native，Tomcat直接启动就支持apr。</li></ul><h2 id="四、tomcat有几种部署方式" tabindex="-1">四、Tomcat有几种部署方式？ <a class="header-anchor" href="#四、tomcat有几种部署方式" aria-label="Permalink to &quot;四、Tomcat有几种部署方式？&quot;">​</a></h2><p><strong>在Tomcat中部署Web应用的方式主要有如下几种：</strong></p><ol><li>利用Tomcat的自动部署。 把web应用拷贝到webapps目录。Tomcat在启动时会加载目录下的应用，并将编译后的结果放入work目录下。</li><li>使用Manager App控制台部署。 在tomcat主页点击“Manager App” 进入应用管理控制台，可以指定一个web应用的路径或war文件。</li><li>修改conf/server.xml文件部署。 修改conf/server.xml文件，增加Context节点可以部署应用。</li><li>增加自定义的Web部署文件。 在conf/Catalina/localhost/ 路径下增加 xyz.xml文件，内容是Context节点，可以部署应用。</li></ol><h2 id="五、tomcat容器是如何创建servlet类实例-用到了什么原理" tabindex="-1">五、tomcat容器是如何创建servlet类实例？用到了什么原理？ <a class="header-anchor" href="#五、tomcat容器是如何创建servlet类实例-用到了什么原理" aria-label="Permalink to &quot;五、tomcat容器是如何创建servlet类实例？用到了什么原理？&quot;">​</a></h2><ol><li>当容器启动时，会读取在webapps目录下所有的web应用中的web.xml文件，然后对 <strong>xml文件进行解析，并读取servlet注册信息</strong>。然后，将每个应用中注册的servlet类都进行加载，并通过 <strong>反射的方式实例化</strong>。（有时候也是在第一次请求时实例化）</li><li>在servlet注册时加上1如果为正数，则在一开始就实例化，如果不写或为负数，则第一次请求实例化。</li></ol><h2 id="六、tomcat工作模式" tabindex="-1">六、Tomcat工作模式 <a class="header-anchor" href="#六、tomcat工作模式" aria-label="Permalink to &quot;六、Tomcat工作模式&quot;">​</a></h2><p>Tomcat作为servlet容器，有三种工作模式：</p><ul><li>1、独立的servlet容器，servlet容器是web服务器的一部分；</li><li>2、进程内的servlet容器，servlet容器是作为web服务器的插件和java容器的实现，web服务器插件在内部地址空间打开一个jvm使得java容器在内部得以运行。反应速度快但伸缩性不足；</li><li>3、进程外的servlet容器，servlet容器运行于web服务器之外的地址空间，并作为web服务器的插件和java容器实现的结合。反应时间不如进程内但伸缩性和稳定性比进程内优；</li></ul><p>进入Tomcat的请求可以根据Tomcat的工作模式分为如下两类：</p><ul><li>Tomcat作为应用程序服务器：请求来自于前端的web服务器，这可能是Apache, IIS, Nginx等；</li><li>Tomcat作为独立服务器：请求来自于web浏览器；</li></ul><p>面试时问到Tomcat相关问题的几率并不高，正式因为如此，很多人忽略了对Tomcat相关技能的掌握，下面这一篇文章整理了Tomcat相关的系统架构，介绍了Server、Service、Connector、Container之间的关系，各个模块的功能，可以说把这几个掌握住了，Tomcat相关的面试题你就不会有任何问题了！另外，在面试的时候你还要有意识无意识的往Tomcat这个地方引，就比如说常见的Spring MVC的执行流程，一个URL的完整调用链路，这些相关的题目你是可以往Tomcat处理请求的这个过程去说的！掌握了Tomcat这些技能，面试官一定会佩服你的！</p><p>学了本章之后你应该明白的是：</p><ul><li>Server、Service、Connector、Container四大组件之间的关系和联系，以及他们的主要功能点；</li><li>Tomcat执行的整体架构，请求是如何被一步步处理的；</li><li>Engine、Host、Context、Wrapper相关的概念关系；</li><li>Container是如何处理请求的；</li><li>Tomcat用到的相关设计模式；</li></ul><h2 id="七、tomcat顶层架构" tabindex="-1">七、Tomcat顶层架构 <a class="header-anchor" href="#七、tomcat顶层架构" aria-label="Permalink to &quot;七、Tomcat顶层架构&quot;">​</a></h2><p>俗话说，站在巨人的肩膀上看世界，一般学习的时候也是先总览一下整体，然后逐个部分个个击破，最后形成思路，了解具体细节，Tomcat的结构很复杂，但是 Tomcat 非常的模块化，找到了 Tomcat 最核心的模块，问题才可以游刃而解，了解了 Tomcat 的整体架构对以后深入了解 Tomcat 来说至关重要！</p><p>先上一张Tomcat的顶层结构图（图A），如下：</p><p><img src="/assets/1599816578811-994aebb1-2054-4b68-882a-a35de645a30a.C944Q9kr.png" alt="img"></p><p>Tomcat中最顶层的容器是Server，代表着整个服务器，从上图中可以看出，一个Server可以包含至少一个Service，即可以包含多个Service，用于具体提供服务。</p><p>Service主要包含两个部分：Connector和Container。从上图中可以看出 Tomcat 的心脏就是这两个组件，他们的作用如下：</p><ul><li>Connector用于处理连接相关的事情，并提供Socket与Request请求和Response响应相关的转化;</li><li>Container用于封装和管理Servlet，以及具体处理Request请求；</li></ul><p>一个Tomcat中只有一个Server，一个Server可以包含多个Service，一个Service只有一个Container，但是可以有多个Connectors，这是因为一个服务可以有多个连接，如同时提供Http和Https链接，也可以提供向相同协议不同端口的连接，示意图如下（Engine、Host、Context下面会说到）：</p><p><img src="/assets/1599816599388-5497ea15-756a-453f-9c5e-126dd768c90c.BukbB5QB.png" alt="img"></p><p>多个 Connector 和一个 Container 就形成了一个 Service，有了 Service 就可以对外提供服务了，但是 Service 还要一个生存的环境，必须要有人能够给她生命、掌握其生死大权，那就非 Server 莫属了！所以整个 Tomcat 的生命周期由 Server 控制。</p><p>另外，上述的包含关系或者说是父子关系，都可以在tomcat的conf目录下的server.xml配置文件中看出，下图是删除了注释内容之后的一个完整的server.xml配置文件（Tomcat版本为8.0）</p><p><img src="/assets/1599816633703-4e6b115b-ea35-4102-bd9b-cee4f88abb39.BRwjHwHF.png" alt="img"></p><p>详细的配置文件内容可以到Tomcat官网查看：<a href="http://tomcat.apache.org/tomcat-8.0-doc/index.html" target="_blank" rel="noreferrer">Tomcat配置文件</a></p><p>上边的配置文件，还可以通过下边的一张结构图更清楚的理解：</p><p><img src="/assets/1599816655530-40b120c1-40ee-4a54-a8f3-46876e2a7557.2aXc3LY3.png" alt="img"></p><p>Server标签设置的端口号为8005，shutdown=”SHUTDOWN” ，表示在8005端口监听“SHUTDOWN”命令，如果接收到了就会关闭Tomcat。一个Server有一个Service，当然还可以进行配置，一个Service有多个Connector，Service左边的内容都属于Container的，Service下边是Connector。</p><h3 id="_1-tomcat顶层架构小结" tabindex="-1">1 Tomcat顶层架构小结 <a class="header-anchor" href="#_1-tomcat顶层架构小结" aria-label="Permalink to &quot;1 Tomcat顶层架构小结&quot;">​</a></h3><ol><li>Tomcat中只有一个Server，一个Server可以有多个Service，一个Service可以有多个Connector和一个Container；</li><li>Server掌管着整个Tomcat的生死大权；</li><li>Service 是对外提供服务的；</li><li>Connector用于接受请求并将请求封装成Request和Response来具体处理；</li><li>Container用于封装和管理Servlet，以及具体处理request请求；</li></ol><p>知道了整个Tomcat顶层的分层架构和各个组件之间的关系以及作用，对于绝大多数的开发人员来说Server和Service对我们来说确实很远，而我们开发中绝大部分进行配置的内容是属于Connector和Container的，所以接下来介绍一下Connector和Container。</p><h2 id="八、connector和container的微妙关系" tabindex="-1">八、Connector和Container的微妙关系 <a class="header-anchor" href="#八、connector和container的微妙关系" aria-label="Permalink to &quot;八、Connector和Container的微妙关系&quot;">​</a></h2><p>由上述内容我们大致可以知道一个请求发送到Tomcat之后，首先经过Service然后会交给我们的Connector，Connector用于接收请求并将接收的请求封装为Request和Response来具体处理，Request和Response封装完之后再交由Container进行处理，Container处理完请求之后再返回给Connector，最后在由Connector通过Socket将处理的结果返回给客户端，这样整个请求的就处理完了！</p><p>Connector最底层使用的是Socket来进行连接的，Request和Response是按照HTTP协议来封装的，所以Connector同时需要实现TCP/IP协议和HTTP协议！</p><p>Tomcat既然需要处理请求，那么肯定需要先接收到这个请求，接收请求这个东西我们首先就需要看一下Connector！</p><p>Connector架构分析</p><p>Connector用于接受请求并将请求封装成Request和Response，然后交给Container进行处理，Container处理完之后在交给Connector返回给客户端。</p><p>因此，我们可以把Connector分为四个方面进行理解：</p><ol><li>Connector如何接受请求的？</li><li>如何将请求封装成Request和Response的？</li><li>封装完之后的Request和Response如何交给Container进行处理的？</li><li>Container处理完之后如何交给Connector并返回给客户端的？</li></ol><p>首先看一下Connector的结构图（图B），如下所示：</p><p><img src="/assets/1599816679885-7c87f5c3-9e2b-427a-9b48-df3b33499813.BMFDCLJx.png" alt="img"></p><p>Connector就是使用ProtocolHandler来处理请求的，不同的ProtocolHandler代表不同的连接类型，比如：Http11Protocol使用的是普通Socket来连接的，Http11NioProtocol使用的是NioSocket来连接的。</p><p>其中ProtocolHandler由包含了三个部件：Endpoint、Processor、Adapter。</p><ol><li>Endpoint用来处理底层Socket的网络连接，Processor用于将Endpoint接收到的Socket封装成Request，Adapter用于将Request交给Container进行具体的处理。</li><li>Endpoint由于是处理底层的Socket网络连接，因此Endpoint是用来实现TCP/IP协议的，而Processor用来实现HTTP协议的，Adapter将请求适配到Servlet容器进行具体的处理。</li><li>Endpoint的抽象实现AbstractEndpoint里面定义的Acceptor和AsyncTimeout两个内部类和一个Handler接口。Acceptor用于监听请求，AsyncTimeout用于检查异步Request的超时，Handler用于处理接收到的Socket，在内部调用Processor进行处理。</li></ol><p>至此，我们应该很轻松的回答1，2，3的问题了，但是4还是不知道，那么我们就来看一下Container是如何进行处理的以及处理完之后是如何将处理完的结果返回给Connector的？</p><h2 id="九、container架构分析" tabindex="-1">九、Container架构分析 <a class="header-anchor" href="#九、container架构分析" aria-label="Permalink to &quot;九、Container架构分析&quot;">​</a></h2><p>Container用于封装和管理Servlet，以及具体处理Request请求，在Container内部包含了4个子容器，结构图如下（图C）：</p><p><img src="/assets/1599816701859-9ec5fbe0-4489-4e58-ab39-8bd68a482f7e.mwZi8nqq.png" alt="img"></p><p>4个子容器的作用分别是：</p><ol><li>Engine：引擎，用来管理多个站点，一个Service最多只能有一个Engine；</li><li>Host：代表一个站点，也可以叫虚拟主机，通过配置Host就可以添加站点；</li><li>Context：代表一个应用程序，对应着平时开发的一套程序，或者一个WEB-INF目录以及下面的web.xml文件；</li><li>Wrapper：每一Wrapper封装着一个Servlet；</li></ol><p>下面找一个Tomcat的文件目录对照一下，如下图所示：</p><p><img src="/assets/1599816731311-a620bc21-ffa1-4bca-b7fc-fddf56e68ee6.BOq5qUzj.png" alt="img"></p><p>Context和Host的区别是Context表示一个应用，我们的Tomcat中默认的配置下webapps下的每一个文件夹目录都是一个Context，其中ROOT目录中存放着主应用，其他目录存放着子应用，而整个webapps就是一个Host站点。</p><p>我们访问应用Context的时候，如果是ROOT下的则直接使用域名就可以访问，例如：www.baidu.com，如果是Host（webapps）下的其他应用，则可以使用www.baidu.com/docs进行访问，当然默认指定的根应用（ROOT）是可以进行设定的，只不过Host站点下默认的主应用是ROOT目录下的。</p><p>看到这里我们知道Container是什么，但是还是不知道Container是如何进行请求处理的以及处理完之后是如何将处理完的结果返回给Connector的？别急！下边就开始探讨一下Container是如何进行处理的！</p><h3 id="_1-container如何处理请求的" tabindex="-1">1 Container如何处理请求的 <a class="header-anchor" href="#_1-container如何处理请求的" aria-label="Permalink to &quot;1 Container如何处理请求的&quot;">​</a></h3><p>Container处理请求是使用Pipeline-Valve管道来处理的！（Valve是阀门之意）</p><p>Pipeline-Valve是<strong>责任链模式</strong>，责任链模式是指在一个请求处理的过程中有很多处理者依次对请求进行处理，每个处理者负责做自己相应的处理，处理完之后将处理后的结果返回，再让下一个处理者继续处理。</p><p><img src="/assets/1599816753701-4c78ae0c-acbd-4710-a7ed-644e56c31ecb.adZmCXCy.png" alt="img"></p><p>但是！Pipeline-Valve使用的责任链模式和普通的责任链模式有些不同！区别主要有以下两点：</p><ul><li>每个Pipeline都有特定的Valve，而且是在管道的最后一个执行，这个Valve叫做BaseValve，BaseValve是不可删除的；</li><li>在上层容器的管道的BaseValve中会调用下层容器的管道。</li></ul><p>我们知道Container包含四个子容器，而这四个子容器对应的BaseValve分别在：StandardEngineValve、StandardHostValve、StandardContextValve、StandardWrapperValve。</p><p>Pipeline的处理流程图如下（图D）：</p><p><img src="/assets/1599816775140-a38682a5-3449-4215-97be-92ff227c51bf.Dxx6qpMc.png" alt="img"></p><ul><li>Connector在接收到请求后会首先调用最顶层容器的Pipeline来处理，这里的最顶层容器的Pipeline就是EnginePipeline（Engine的管道）；</li><li>在Engine的管道中依次会执行EngineValve1、EngineValve2等等，最后会执行StandardEngineValve，在StandardEngineValve中会调用Host管道，然后再依次执行Host的HostValve1、HostValve2等，最后在执行StandardHostValve，然后再依次调用Context的管道和Wrapper的管道，最后执行到StandardWrapperValve。</li><li>当执行到StandardWrapperValve的时候，会在StandardWrapperValve中创建FilterChain，并调用其doFilter方法来处理请求，这个FilterChain包含着我们配置的与请求相匹配的Filter和Servlet，其doFilter方法会依次调用所有的Filter的doFilter方法和Servlet的service方法，这样请求就得到了处理！</li><li>当所有的Pipeline-Valve都执行完之后，并且处理完了具体的请求，这个时候就可以将返回的结果交给Connector了，Connector在通过Socket的方式将结果返回给客户端。</li></ul><h2 id="十一、总结" tabindex="-1">十一、总结 <a class="header-anchor" href="#十一、总结" aria-label="Permalink to &quot;十一、总结&quot;">​</a></h2><p>至此，我们已经对Tomcat的整体架构有了大致的了解，从图A、B、C、D可以看出来每一个组件的基本要素和作用。我们在脑海里应该有一个大概的轮廓了！如果你面试的时候，让你简单的聊一下Tomcat，上面的内容你能脱口而出吗？当你能够脱口而出的时候，面试官一定会对你刮目相看的！</p></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-e257564d><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><a class="VPLink link pager-link prev" href="/%E6%9C%8D%E5%8A%A1%E5%99%A8/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-Linux.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>上一篇</span><span class="title" data-v-e257564d>操作系统-Linux</span><!--]--></a></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/%E6%9C%8D%E5%8A%A1%E5%99%A8/%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%8C%96%E6%8A%80%E6%9C%AF-Mysql.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>下一篇</span><span class="title" data-v-e257564d>数据持久化技术-Mysql</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"index.md\":\"DD4dneuI\",\"java ee_基础框架_javaspring.md\":\"Bk44FKGG\",\"java ee_基础框架_springboot.md\":\"_2Y2lhFp\",\"java ee_基础框架_springmvc.md\":\"BtsAEzqO\",\"java ee_微服务_springcloud.md\":\"BrYK1b_r\",\"java ee_微服务_三方调用框架-openfeign.md\":\"BkVAdei-\",\"java ee_微服务_分布式流量控制框架-sentinel.md\":\"DgkEl07o\",\"java ee_微服务_分布式消息框架rabbitmq-.md\":\"C8VmAnwF\",\"java ee_微服务_列表.md\":\"BO-zGMwU\",\"java ee_微服务_服务注册和发现-nacos.md\":\"DyYm6nAD\",\"java se_javajvm深入理解.md\":\"BiO7hleS\",\"java se_java基础.md\":\"CLo-W_1w\",\"java se_java并发编程.md\":\"Bw_xiJuV\",\"java se_java异常.md\":\"zNhmr9rc\",\"java se_java集合框架.md\":\"CuwwILi1\",\"java se_列表.md\":\"CrBHK71Y\",\"回顾_数据库相关.md\":\"CQ5iaMn4\",\"开发工具_代码管理工具-git.md\":\"Brt-ghMw\",\"开发工具_列表.md\":\"BfI7-x7Y\",\"服务器_列表.md\":\"WOc8TPRF\",\"服务器_容器化技术-docker.md\":\"yf5NilfR\",\"服务器_操作系统-linux.md\":\"-124a8hk\",\"服务器_数据持久化技术-mysql.md\":\"zhEi7rnz\",\"服务器_数据缓存技术-redis.md\":\"Y4coG5Gw\",\"服务器_轻量级服务器-tomcat.md\":\"DbNj8TZK\",\"若依框架_若以数据表分析.md\":\"C-pnXuJe\",\"高项_第8章 项目整合管理.md\":\"BKItv5Aj\",\"高项_第9章 项目范围管理.md\":\"B4y_npvt\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"DBLOG\",\"description\":\"学而不思则罔\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"/logo.png\",\"nav\":[{\"text\":\"首页\",\"link\":\"/\"},{\"text\":\"高项\",\"items\":[{\"text\":\"第8章 项目整合管理\",\"link\":\"/高项/第8章 项目整合管理\"},{\"text\":\"第9章 项目范围管理\",\"link\":\"/高项/第9章 项目范围管理\"}]},{\"text\":\"汇总\",\"items\":[{\"text\":\"Java SE\",\"link\":\"/Java SE/Java基础.md\"},{\"text\":\"Java EE\",\"link\":\"/Java EE/基础框架/JavaSpring\"},{\"text\":\"服务器\",\"link\":\"/服务器/容器化技术-Docker.md\"},{\"text\":\"开发工具\",\"link\":\"/开发工具/代码管理工具-Git.md\"},{\"text\":\"回顾\",\"link\":\"/回顾/数据库相关.md\"}]}],\"sidebar\":{\"/Java SE/\":{\"text\":\"Java SE\",\"items\":[{\"text\":\"Java基础\",\"link\":\"/Java SE/Java基础\"},{\"text\":\"Java集合框架\",\"link\":\"/Java SE/Java集合框架.md\"},{\"text\":\"Java异常\",\"link\":\"/Java SE/Java异常\"},{\"text\":\"Java并发编程\",\"link\":\"/Java SE/Java并发编程\"},{\"text\":\"JavaJVM深入理解\",\"link\":\"/Java SE/JavaJVM深入理解\"}]},\"/Java EE/\":[{\"text\":\"基础框架\",\"items\":[{\"text\":\"JavaSpring\",\"link\":\"/Java EE/基础框架/JavaSpring\"},{\"text\":\"SpringMVC\",\"link\":\"/Java EE/基础框架/SpringMVC\"},{\"text\":\"SpringBoot\",\"link\":\"/Java EE/基础框架/SpringBoot\"}],\"collapsed\":false},{\"text\":\"微服务\",\"items\":[{\"text\":\"SpringCloud\",\"link\":\"/Java EE/微服务/SpringCloud\"},{\"text\":\"服务注册和发现-Nacos\",\"link\":\"/Java EE/微服务/服务注册和发现-nacos\"},{\"text\":\"三方调用框架-OpenFeign\",\"link\":\"/Java EE/微服务/三方调用框架-OpenFeign.md\"},{\"text\":\"分布式消息框架-RabbitMQ\",\"link\":\"/Java EE/微服务/分布式消息框架RabbitMQ-.md\"},{\"text\":\"分布式流量控制框架-Sentinel\",\"link\":\"/Java EE/微服务/分布式流量控制框架-Sentinel.md\"}],\"collapsed\":false}],\"/服务器/\":{\"text\":\"服务器\",\"items\":[{\"text\":\"容器化技术-Docker\",\"link\":\"/服务器/容器化技术-Docker.md\"},{\"text\":\"操作系统-Linux\",\"link\":\"/服务器/操作系统-Linux\"},{\"text\":\"轻量级服务器-Tomcat\",\"link\":\"/服务器/轻量级服务器-Tomcat\"},{\"text\":\"数据持久化技术-Mysql\",\"link\":\"/服务器/数据持久化技术-Mysql.md\"},{\"text\":\"数据缓存技术-Redis\",\"link\":\"/服务器/数据缓存技术-Redis.md\"}]},\"/开发工具/\":{\"text\":\"开发工具\",\"items\":[{\"text\":\"代码管理工具-Git\",\"link\":\"/开发工具/代码管理工具-Git.md\"}]},\"/回顾/\":{\"text\":\"回顾\",\"items\":[{\"text\":\"数据库相关\",\"link\":\"/回顾/数据库相关.md\"}]}},\"docFooter\":{\"prev\":\"上一篇\",\"next\":\"下一篇\"},\"search\":{\"provider\":\"local\"},\"outline\":\"deep\",\"aside\":\"left\",\"outlineTitle\":\"页面导航\",\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/dwxlrf\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>